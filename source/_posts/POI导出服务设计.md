---
title: POI导出服务设计
avatar: /images/author.gif
categories: 自学教程
comments: true
date: 2019-04-26 17:57:53
author: MoMik
authorLink:
authorAbout:
authorDesc:
tags:
keywords:
description:
photos: http://wx3.sinaimg.cn/large/0069lHOigy1g2g7tsev17j30u00do42l.jpg
---

### 序言
先让我吐槽3分钟...
今天项目经理给我建了一个JIRA"参考其他功能代码编写某某功能的PPT导出" 额 看标题还算比较正经算是码农日常。于是我找到了之前的代码。第一眼给我的感觉就是“这TM是人写的代码？？？” 最基本的封装也只是针对单个业务，也就是说我想写个导出还要把处理导出部分[通用]代码再写一遍，而且代码层次混乱并不利于新进人员快速上手。长叹一声便开始重构这部分导出代码【强迫症】
### 设计思路
首先业务场景是一家做的样衣外贸公司，PPT主要针对样衣资料进行展示发送给客户参考。
但是客户并不只有一家，每家给的模版是不相同的也就是说你需要填充的字段会不同。首先一个服务全部搞定不太现实【一个服务就意味着你全部客户代码全部耦合在一起】，这就需要我们将模版服务插件化：

1. 通用数据服务提供
2. 通用业务处理
3. 规范化导出接口
4. 插件化模版导出业务处理
5. 服务分发


#### 通用数据服务提供
这部分主要是用来提供通用的数据，说白了就是某些字段会经常出现在很多模版里，又或者如查询产品图片等这些常用数据。目的就是不做重复的查询。

#### 通用数据服务提供
用来处理你在“通用数据服务提供”查询到的数据，因为我们查询到的原始数据并不足以应对页面上的要求，需要我们进行特殊处理。

#### 规范化导出接口
将导出服务抽象化为一个接口,所有插件（即不同模版导出服务）必须实现该接口。
之所以规范化导出接口首先是为了我们能够使用“服务分发”功能，其次是为了代码的整洁性【不要张三起这个方法名李四起那个方法名】

#### 插件化模版导出业务处理
针对不同模版提供不同的业务处理，可插拔式封装，一个模版对应一个插件，增加模版即增加插件。

#### 服务分发
导出请求发送到后台后，根据需要导出模版的类型启动对应该模版的插件（本文导出服务我们统一叫做插件）
和分布式应用的服务网关理念相同。

> 这里我们利用了Spring对Bean管理的特性，插件是一个被Spring管理的Bean当我们需要这个插件的时候,通过名称从Spring上下文中取出该插件